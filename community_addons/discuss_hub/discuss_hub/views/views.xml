<odoo>
    <!-- explicit list view definition -->

    <record model="ir.ui.view" id="list">
        <field name="name">Discuss Hub Connector list</field>
        <field name="model">discuss_hub.connector</field>
        <field name="arch" type="xml">
            <list>
                <field name="enabled" />
                <field name="import_contacts" />
                <field name="name" />
                <field name="type" />
                <field name="uuid" />
                <field name="url" />
                <field name="api_key" />
                <field name="manager_channel" />
            </list>
        </field>
    </record>

    <!-- explicit kanban definition -->
    <record id="connector_model_view_kanban" model="ir.ui.view">
        <field name="name">discuss_hub.connector.view.kanban</field>
        <field name="model">discuss_hub.connector</field>
        <field name="arch" type="xml">
            <kanban class="o_kanban_mobile" sample="1">
                <field name="name" />
                <field name="enabled" />
                <field name="status" />
                <field name="description" />
                <field name="type" />
                <templates>
                    <t t-name="card">
                        <div t-attf-class="oe_kanban_global_click">
                            <!-- Ribbon -->
                            <t t-if="record.status.raw_value == 'not_found'">
                                <widget
                                    name="web_ribbon"
                                    title="NOT FOUND"
                                    bg_color="text-bg-info"
                                />
                            </t>
                            <t t-if="record.status.raw_value == 'open'">
                                <widget
                                    name="web_ribbon"
                                    title="Open"
                                    bg_color="text-bg-success"
                                />
                            </t>
                            <t t-if="record.status.raw_value == 'closed'">
                                <widget
                                    name="web_ribbon"
                                    title="Closed"
                                    bg_color="text-bg-danger"
                                />
                            </t>
                            <t t-if="record.status.raw_value == 'error'">
                                <widget
                                    name="web_ribbon"
                                    title="Error"
                                    bg_color="text-bg-warning"
                                />
                            </t>

                            <div class="row">
                                <div class="col-12">
                                    <!---
            add success if enabled, danger if disabled
            -->
                                    <t t-if="record.enabled.raw_value">
                                        <strong class="me-3 text-success">
                                            <field name="name" />
                                        </strong>
                                    </t>
                                    <t t-else="">
                                        <strong class="me-3 text-danger">
                                            <field name="name" />
                                        </strong>
                                    </t>
                                </div>
                            </div>
                            <t t-if="record.description.value">
                                <field name="description" /><br /> Type: <field
                                name="type"
                            />
                            </t>
                            <br />
                            <small> Total Channels: <field name="channels_total" /><br
                            /> Last message: <field name="last_message_date" />
                            </small>

                            <!-- Button to trigger action
        if status is open, show restart and close
        else show start
        -->
                            <div class="mt8 float-end">
                                <t t-if="record.status.raw_value == 'open'">
                                    <button
                                        class="btn btn-warning btn-sm"
                                        name="restart_instance"
                                        type="object"
                                    >
                                        Restart
                                    </button>
                                    <button
                                        class="btn btn-danger btn-sm ms-1"
                                        name="logout_instance"
                                        type="object"
                                    >
                                        Logout
                                    </button>
                                </t>
                                <t t-if="record.status.raw_value == 'closed'">
                                    <button
                                        class="btn btn-success btn-sm ms-1"
                                        name="action_open_start"
                                        type="object"
                                    >
                                        Start
                                    </button>
                                </t>
                            </div>
                        </div>
                    </t>
                </templates>
            </kanban>
        </field>
    </record>

    <!-- connector form -->

    <record id="connector_model_view_form" model="ir.ui.view">
        <field name="name">discuss_hub.connector.view.form</field>
        <field name="model">discuss_hub.connector</field>
        <field name="arch" type="xml">
            <form string="Discuss Hub Connector">
                <sheet>
                    <group>
                        <group>
                            <field name="enabled" />
                            <field name="name" />
                            <field name="description" />
                            <field name="type" />
                            <field name="uuid" />
                            <field name="url" />
                            <field name="api_key" />
                            <field name="text_message_template" />
                            <field name="reopen_last_archived_channel" />
                            <field name="always_update_profile_picture" />
                            <field name="show_read_receipts" />
                            <field name="notify_reactions" />
                            <field name="import_contacts" />
                        </group>
                        <group>
                            <field name="status" />

                            <field name="manager_channel" widget="many2many_tags" />

                            <field
                                name="automatic_added_partners"
                                widget="many2many_tags"
                            />
                            <field
                                name="automatic_added_teams"
                                widget="many2many_tags"
                            />
                            <field name="default_admin_partner_id" widget="many2one" />
                            <field name="partner_contact_name" />
                            <field name="partner_contact_field" />
                        </group>
                    </group>

                    <notebook>
                        <!-- add a page for Evolution -->
                        <page string="Evolution">
                            <group>
                                <field name="evolution_allow_broadcast_messages" />
                                <button
                                    type="object"
                                    name="sync_contacts"
                                    string="Sync Contacts"
                                    class="btn btn-primary"
                                />
                                <field
                                    name="evolution_contacts_storage_count"
                                    string="Number of Contacts in Queue to Sync"
                                />
                            </group>
                        </page>
                        <!-- add a page for WhatsApp Cloud -->
                        <page string="WhatsApp Cloud">
                            <group>
                                <field
                                    name="verify_token"
                                    string="Verify Token to WhatsApp"
                                />
                                <field name="whatsapp_cloud_reengage_template" />
                            </group>
                        </page>
                    </notebook>
                </sheet>
            </form>
        </field>
    </record>

    <!-- actions opening views on models -->

    <record model="ir.actions.act_window" id="action_window">
        <field name="name">List Connectors</field>
        <field name="res_model">discuss_hub.connector</field>
        <field name="view_mode">kanban,list,form</field>
    </record>

    <!-- server action to the one above -->

    <record model="ir.actions.server" id="action_server">
        <field name="name">discuss hub server</field>
        <field name="model_id" ref="model_discuss_hub_connector" />
        <field name="state">code</field>
        <field name="code">
            action = {
            "type": "ir.actions.act_window",
            "view_mode": "list,form",
            "res_model": model._name,
            }
        </field>
    </record>

    <!-- Top menu item -->

    <menuitem name="Discuss Hub" id="discuss_hub.menu_root" />

    <!-- menu categories -->

    <menuitem
        name="Conectors"
        id="discuss_hub.connector"
        parent="discuss_hub.menu_root"
        action="discuss_hub.action_window"
    />

    <!-- actions -->

    <!-- explicit channel list view definition -->

    <record model="ir.actions.act_window" id="action_window_list_channels">
        <field name="name">List Channels</field>
        <field name="res_model">discuss.channel</field>
        <field name="view_mode">kanban,list,form</field>
        <field name="domain">[("discuss_hub_connector", "!=", False)]</field>
    </record>

    <record model="ir.ui.view" id="discuss_hub_channel_list">
        <field name="name">discuss_hub Channel List</field>
        <field name="model">discuss.channel</field>
        <field name="arch" type="xml">
            <list>
                <field name="active" />
                <field name="name" />
                <field name="create_date" />
                <field name="last_interest_dt" />
                <field name="write_uid" />
                <field name="discuss_hub_connector" />
                <field name="channel_partner_ids" />
            </list>
        </field>
    </record>

    <record id="discuss_hub_action_view_list" model="ir.actions.act_window.view">
        <field name="act_window_id" ref="action_window_list_channels" />
        <field name="view_mode">list</field>
        <field name="view_id" ref="discuss_hub_channel_list" />
        <field name="sequence" eval="1" />
    </record>

    <menuitem
        name="Channels"
        id="discuss_hub.channels_list"
        parent="discuss_hub.menu_root"
        action="action_window_list_channels"
    />

    <!-- team list view definition-->
    <record model="ir.actions.act_window" id="action_window_list_team">
        <field name="name">List Teams</field>
        <field name="res_model">discuss_hub.routing_team</field>
        <field name="view_mode">kanban,list,form</field>
    </record>

    <record model="ir.ui.view" id="discuss_hub_form_team">
        <field name="name">discuss_hub Team Form</field>
        <field name="model">discuss_hub.routing_team</field>
        <field name="arch" type="xml">
            <form string="Routing Team">
                <sheet>
                    <group>
                        <field name="name" />
                        <field name="routing_strategy" />
                        <field name="online_users_only" />
                    </group>
                    <notebook>
                        <page string="Team Members" invisible="not id">
                            <field
                                name="team_member_ids"
                                context="{'default_team_id': id}"
                            >
                                <list>
                                    <field name="user_id" />
                                    <field name="order" />
                                    <field name="count" />
                                </list>
                            </field>
                        </page>
                    </notebook>
                </sheet>
            </form>
        </field>
    </record>

    <record model="ir.ui.view" id="discuss_hub_list_team">
        <field name="name">discuss_hub Team List</field>
        <field name="model">discuss_hub.routing_team</field>
        <field name="arch" type="xml">
            <list>
                <field name="name" />
                <field name="team_member_ids" />
            </list>
        </field>
    </record>

    <record model="ir.ui.view" id="discuss_hub_list_team_member">
        <field name="name">discuss_hub Team List</field>
        <field name="model">discuss_hub.routing_team_member</field>
        <field name="arch" type="xml">
            <list>
                <field name="user_id" />
                <field name="order" />
                <field name="count" />
            </list>
        </field>
    </record>

    <record id="discuss_hub_action_view_list_team" model="ir.actions.act_window.view">
        <field name="act_window_id" ref="action_window_list_team" />
        <field name="view_mode">list</field>
        <field name="view_id" ref="discuss_hub_list_team" />
        <field name="sequence" eval="1" />
    </record>

    <menuitem
        name="Teams"
        id="discuss_hub.routing_team"
        parent="discuss_hub.menu_root"
        action="action_window_list_team"
    />
    <!-- bot list view definition-->

    <record model="ir.actions.act_window" id="action_window_list_bot">
        <field name="name">Bots/Agents</field>
        <field name="res_model">discuss_hub.bot_manager</field>
        <field name="view_mode">kanban,list,form</field>
    </record>

    <record model="ir.ui.view" id="discuss_hub_list_bot">
        <field name="name">discuss_hub Bot List</field>
        <field name="model">discuss_hub.bot_manager</field>
        <field name="arch" type="xml">
            <list>
                <field name="active" />
                <!-- <field name="user" /> -->
                <field name="bot_type" />
            </list>
        </field>
    </record>

    <record id="discuss_hub_action_view_list_bot" model="ir.actions.act_window.view">
        <field name="act_window_id" ref="action_window_list_bot" />
        <field name="view_mode">list</field>
        <field name="view_id" ref="discuss_hub_list_bot" />
        <field name="sequence" eval="1" />
    </record>

    <menuitem
        name="Bot/Agents"
        id="discuss_hub.bot_manager"
        parent="discuss_hub.menu_root"
        action="action_window_list_bot"
    />
</odoo>
